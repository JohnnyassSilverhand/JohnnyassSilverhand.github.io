<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="prefer-datetime-locale" content="en"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Computer Network: Application Layer" /><meta property="og:locale" content="en" /><meta name="description" content="A minimal, responsive, and powerful Jekyll theme for presenting professional writing." /><meta property="og:description" content="A minimal, responsive, and powerful Jekyll theme for presenting professional writing." /><link rel="canonical" href="https://witchpuff.github.io/posts/Application/" /><meta property="og:url" content="https://witchpuff.github.io/posts/Application/" /><meta property="og:site_name" content="CyberWitch" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-02-10T09:36:30+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Computer Network: Application Layer" /><meta name="twitter:site" content="@twitter_username" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-03-29T21:57:24+08:00","datePublished":"2023-02-10T09:36:30+08:00","description":"A minimal, responsive, and powerful Jekyll theme for presenting professional writing.","headline":"Computer Network: Application Layer","mainEntityOfPage":{"@type":"WebPage","@id":"https://witchpuff.github.io/posts/Application/"},"url":"https://witchpuff.github.io/posts/Application/"}</script><title>Computer Network: Application Layer | CyberWitch</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="CyberWitch"><meta name="application-name" content="CyberWitch"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img class="avatar" alt="WitchPuff" width="100" height="100" data-proofer-ignore="true" src="https://avatars2.githubusercontent.com/WitchPuff?v=3&s=100" srcset="https://avatars2.githubusercontent.com/WitchPuff?v=3&s=100 1x, https://avatars2.githubusercontent.com/WitchPuff?v=3&s=200 2x, https://avatars2.githubusercontent.com/WitchPuff?v=3&s=300 3x, https://avatars2.githubusercontent.com/WitchPuff?v=3&s=400 4x" /> </a></div><div class="site-title mt-3"> <a href="/">CyberWitch</a></div><div class="site-subtitle font-italic">A Room of One's Own</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/WitchPuff" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['ttqsjzsq','163.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Computer Network: Application Layer</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Computer Network: Application Layer</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1675992990" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Feb 10, 2023 </em> </span> <span> Updated <em class="" data-ts="1680098244" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Mar 29, 2023 </em> </span><div class="d-flex justify-content-between"> <span> By <em> WitchPuff </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="5815 words"> <em>32 min</em> read</span></div></div></div><div class="post-content"><ul id="markdown-toc"><li><a href="#overview" id="markdown-toc-overview">Overview</a><ul><li><a href="#the--layer-internet-model" id="markdown-toc-the--layer-internet-model">The * Layer Internet Model</a></ul><li><a href="#applications" id="markdown-toc-applications">Applications</a><ul><li><a href="#1-principles-of-network-applications" id="markdown-toc-1-principles-of-network-applications">1. Principles of network applications</a><ul><li><a href="#11-network-application-architectures" id="markdown-toc-11-network-application-architectures">1.1 Network application architectures</a><ul><li><a href="#client-server-architectureclient-server-data-center-advantages-and-shortages-examples" id="markdown-toc-client-server-architectureclient-server-data-center-advantages-and-shortages-examples">client-server architecture(client, server, data center, advantages and shortages, examples)</a><li><a href="#p2p-architecture" id="markdown-toc-p2p-architecture">P2P architecture</a></ul><li><a href="#12-processes-communicating" id="markdown-toc-12-processes-communicating">1.2 Processes Communicating</a><ul><li><a href="#object" id="markdown-toc-object">object</a><li><a href="#interface" id="markdown-toc-interface">interface</a><li><a href="#what-application-developer-controls" id="markdown-toc-what-application-developer-controls">what application developer controls</a></ul><li><a href="#13-transport-services-available-to-applications" id="markdown-toc-13-transport-services-available-to-applications">1.3 Transport Services Available to Applications</a><ul><li><a href="#4-dimensions" id="markdown-toc-4-dimensions">4 dimensions</a></ul><li><a href="#14-transport-services-provided-by-the-internet" id="markdown-toc-14-transport-services-provided-by-the-internet">1.4 Transport Services Provided by the Internet</a><ul><li><a href="#tcp" id="markdown-toc-tcp">TCP</a><li><a href="#secure-sockets-layerssl" id="markdown-toc-secure-sockets-layerssl">Secure Sockets Layer(SSL)</a><li><a href="#udp" id="markdown-toc-udp">UDP</a></ul><li><a href="#15-application-layer-protocols" id="markdown-toc-15-application-layer-protocols">1.5 Application-Layer Protocols</a><ul><li><a href="#what-a-protocol-determines" id="markdown-toc-what-a-protocol-determines">what a protocol determines</a><li><a href="#publicproprietary" id="markdown-toc-publicproprietary">public/proprietary</a></ul></ul><li><a href="#2-the-web-and-http" id="markdown-toc-2-the-web-and-http">2. The Web and HTTP</a><ul><li><a href="#21-httphyper-text-transfer-protocol" id="markdown-toc-21-httphyper-text-transfer-protocol">2.1 HTTP(Hyper Text Transfer Protocol)</a><ul><li><a href="#architecture-client-server" id="markdown-toc-architecture-client-server">architecture: client-server</a><li><a href="#transport-protocol-tcp" id="markdown-toc-transport-protocol-tcp">transport protocol: TCP</a></ul><li><a href="#22-non-persistent-and-persistent-connections" id="markdown-toc-22-non-persistent-and-persistent-connections">2.2 Non-Persistent and Persistent Connections</a><ul><li><a href="#non-persistent-connections" id="markdown-toc-non-persistent-connections">Non-Persistent connections</a><li><a href="#round-trip-timertt" id="markdown-toc-round-trip-timertt">round-trip time(RTT)</a><li><a href="#shortcomings" id="markdown-toc-shortcomings">shortcomings</a><li><a href="#persistent-connections" id="markdown-toc-persistent-connections">persistent connections</a></ul><li><a href="#23-http-message-format" id="markdown-toc-23-http-message-format">2.3 HTTP Message Format</a><ul><li><a href="#request" id="markdown-toc-request">Request</a><li><a href="#response-message" id="markdown-toc-response-message">Response Message</a></ul><li><a href="#24-user-server-interaction-cookies" id="markdown-toc-24-user-server-interaction-cookies">2.4 User-Server Interaction: Cookies</a><li><a href="#25-web-caching" id="markdown-toc-25-web-caching">2.5 Web Caching</a><ul><li><a href="#advantages" id="markdown-toc-advantages">advantages</a><li><a href="#content-distribution-networkscdns" id="markdown-toc-content-distribution-networkscdns">Content Distribution Networks(CDNs)</a><li><a href="#conditional-get" id="markdown-toc-conditional-get">Conditional GET</a></ul></ul><li><a href="#3-electronic-mail" id="markdown-toc-3-electronic-mail">3. Electronic Mail</a><ul><li><a href="#31-internet-mail-system" id="markdown-toc-31-internet-mail-system">3.1 Internet mail system</a><li><a href="#32-comparisons-between-http--smtp" id="markdown-toc-32-comparisons-between-http--smtp">3.2 Comparisons between HTTP &amp; SMTP</a><li><a href="#33-mail-message-formats" id="markdown-toc-33-mail-message-formats">3.3 Mail Message Formats</a><li><a href="#34-mail-access-protocols" id="markdown-toc-34-mail-access-protocols">3.4 Mail Access Protocols</a><ul><li><a href="#post-office-protocolversion-3-pop3" id="markdown-toc-post-office-protocolversion-3-pop3">Post Office Protocol—Version 3 (POP3)</a><li><a href="#internet-mail-access-protocol-imap" id="markdown-toc-internet-mail-access-protocol-imap">Internet Mail Access Protocol (IMAP)</a></ul></ul><li><a href="#4-dnsdomain-name-system" id="markdown-toc-4-dnsdomain-name-system">4. DNS(Domain Name System)</a><ul><li><a href="#41-services-provided-by-dns" id="markdown-toc-41-services-provided-by-dns">4.1 Services provided by DNS</a><ul><li><a href="#definition" id="markdown-toc-definition">definition</a></ul><li><a href="#42-how-dns-works" id="markdown-toc-42-how-dns-works">4.2 How DNS Works</a><ul><li><a href="#3-classes-of-dns-servers" id="markdown-toc-3-classes-of-dns-servers">3 classes of DNS servers</a><li><a href="#cache" id="markdown-toc-cache">cache</a></ul><li><a href="#43-dns-records-and-messages" id="markdown-toc-43-dns-records-and-messages">4.3 DNS Records and Messages</a><ul><li><a href="#参数" id="markdown-toc-参数">参数</a><li><a href="#安全性" id="markdown-toc-安全性">安全性</a></ul><li><a href="#44-distribution" id="markdown-toc-44-distribution">4.4 Distribution</a><ul><li><a href="#p2p-file-distribution" id="markdown-toc-p2p-file-distribution">P2P File Distribution</a><li><a href="#dash" id="markdown-toc-dash">DASH</a><li><a href="#cdn-content-distribution-network" id="markdown-toc-cdn-content-distribution-network">CDN (Content Distribution Network)</a><li><a href="#cluster-selection-strategies" id="markdown-toc-cluster-selection-strategies">cluster selection strategies</a></ul><li><a href="#45-netflix-youtube-and-kankan" id="markdown-toc-45-netflix-youtube-and-kankan">4.5 Netflix, YouTube, and kankan</a><ul><li><a href="#netflix" id="markdown-toc-netflix">Netflix</a><li><a href="#youtube" id="markdown-toc-youtube">YouTube</a></ul><li><a href="#46-client-server-application-using-udptcp" id="markdown-toc-46-client-server-application-using-udptcp">4.6 client-server application using UDP/TCP</a></ul></ul></ul><h1 id="overview">Overview</h1><h2 id="the--layer-internet-model"><span class="mr-2">The * Layer Internet Model</span><a href="#the--layer-internet-model" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="table-wrapper"><table><thead><tr><th>layer<th>application<th>protocol<tbody><tr><td>Application<td>两个应用间的双向可靠字节流传输，例如http/bit-torrent<td>HTTP/SMTP/SSH/FTP<tr><td>Transport<td>TCP/IP保证数据可靠传输；保证正确数据传输顺序正确；<br />UDP<td>TCP/UDP/RTP<tr><td>Network<td>IP is unreliable and makes no guarantees；没有可靠数据传输的保证<td>IP<tr><td>Link<td>通过host和router之间或router之间的单个link来传送数据<td>Ethernet/wifi/DSL/3G<tr><td>Physical<td> <td> </table></div><p>数据传输：</p><p><img data-src="https://raw.githubusercontent.com/WitchPuff/typora_images/main/img/202302140130079.png" alt="image-20220928160445181" style="zoom:50%;" data-proofer-ignore></p><p>7层模型：</p><p><img data-src="https://raw.githubusercontent.com/WitchPuff/typora_images/main/img/202302140130863.png" alt="image-20220928160652649" style="zoom: 33%;" data-proofer-ignore></p><h1 id="applications">Applications</h1><h2 id="1-principles-of-network-applications"><span class="mr-2">1. Principles of network applications</span><a href="#1-principles-of-network-applications" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="11-network-application-architectures"><span class="mr-2">1.1 Network application architectures</span><a href="#11-network-application-architectures" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><em>Summary: architectures for <strong>applications</strong> , not network</em></p><p><em>Conclusion：</em></p><p><em>应用程序的主流体系架构有client-server与P2P两种。</em></p><ol><li><em>在client-server中，存在有<strong>client</strong>、<strong>server</strong>、多台dedicated servers组成的<strong>data center</strong>几种host，客户端之间不能直接通信，服务端是固定的、等待连接的；采用data center集成服务器的好处是有利于响应客户端的所有要求，减少单个服务器的拥堵/过载（集成服务，一对一-&gt;多对多），坏处是提高了带宽代价（servers间的反复互连）。</em>eg. FTP/Web/E-MAIL<li><em>在P2P中，客户端之间进行直连通信，其优点为可扩展性、（对服务器，因为几乎不依赖服务器）低带宽代价，其缺点为安全性低（直连而不通过服务器显然隐蔽性低）、低性能（高度去中心化结构，散点结构）。eg. Skype/迅雷/BitTorrent。</em></ol><p>优缺点的评价维度如下：可扩展、集成服务、带宽代价、安全性、性能</p><div class="table-wrapper"><table><thead><tr><th> <th>client-server<th>P2P<tbody><tr><td>scalability<td> <td>high<tr><td>集成服务<td>high<td>low<tr><td>low bandwith cost<td>No<td>Yes<tr><td>security<td>high<td>low<tr><td>performance<td>high<td>low</table></div><p>我的理解是这样，P2P和中心化网络、分布式网络的区别应该在P2P是host-host，中心化是存在一个data center/中心服务器，分布式是存在多个分布的data center。改天问下chatgpt。。</p><h4 id="client-server-architectureclient-server-data-center-advantages-and-shortages-examples"><span class="mr-2">client-server architecture(client, server, data center, advantages and shortages, examples)</span><a href="#client-server-architectureclient-server-data-center-advantages-and-shortages-examples" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Hosts: client, server, data center(multiple servers)</p><p><img data-src="https://raw.githubusercontent.com/WitchPuff/typora_images/main/img/202211111508988.png" alt="image-20221111150843862" style="zoom:50%;" data-proofer-ignore></p><ol><li>server:<ol><li>fixed address 固定地址<li>always-on 等待连接</ol><li>client:<ol><li>not directly communicate with each other 客户端之间不能直接相互通信</ol><li>data center:<ol><li>including multiple servers 多个服务器组成<li>advantage: solve the problem of incapability of keeping up with all requests 响应需求↑<li>shortage: must pay recurring interconnection and bandwidth costs(with the designs with data centers) 带宽代价↑</ol><li>examples: Web, FTP, Telnet, E-MAIL</ol><h4 id="p2p-architecture"><span class="mr-2">P2P architecture</span><a href="#p2p-architecture" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><img data-src="https://raw.githubusercontent.com/WitchPuff/typora_images/main/img/202211112311789.png" alt="image-20221111231152657" style="zoom:50%;" data-proofer-ignore></p><ol><li>peer-to-peer: directly, without passing through a dedicated server 客户端直连<li>advantage<ol><li>self-scalability 可扩展<li>cost effective, not require significant server infrastructure and server bandwidth 服务器带宽/代价↓</ol><li>shortage: security, performance and reliability due to their highly decentralized structure 安全性、性能↓<li>example: BitTorrent, Xunlei, Skype</ol><h3 id="12-processes-communicating"><span class="mr-2">1.2 Processes Communicating</span><a href="#12-processes-communicating" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><em>Summary: processes running on different hosts(potentially on different operating systems) communicate <strong>through application layer</strong></em></p><p><em>Conclusion: application间的通信本质上是进程间通信，在不同OS、host上运行的进程通过application layer通信。一般将通信双方的进程<strong>标记为client/server</strong>，一个Web process可以既是client（browser process，download operation）也是server（server process，upload operation），该标记是人为的、非绝对的。要进行通信，首先要<strong>确定双方进程的地址，通过 [IP: port number]的形式定位</strong>，IP定位host，端口号定位该host上运行的process；在通信过程中，利用每个host上传输层与应用层/进程与网络之间的<strong>接口Socket</strong>。对于应用层开发者来说，其能控制的是<strong>Socket中所有应用层的部分</strong>，以及<strong>传输层协议及其部分参数</strong>（最大缓冲容量、最大段容量），该application将会建立在开发者选择的传输层协议所提供的服务之上。</em></p><h4 id="object"><span class="mr-2">object</span><a href="#object" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ol><li>label: client(download) process /&amp; server(upload) process<li>Identify Processes: use IP addresses(32 bits, identify the host) and port number(identify the process) to address processes(example: <em>[IP: port number],[localhost:8080]</em>)</ol><p>examples:</p><ol><li><p>a Web server is identified by port number 80.</p><li><p>A mail server process (using the SMTP protocol) is identified by port number 25.</p></ol><h4 id="interface"><span class="mr-2">interface</span><a href="#interface" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>interface between process(application) and network, between application layer and transport layer within a host: <strong>socket (API)</strong></p><p><img data-src="https://raw.githubusercontent.com/WitchPuff/typora_images/main/img/202211112339983.png" alt="image-20221111233944866" style="zoom:50%;" data-proofer-ignore></p><h4 id="what-application-developer-controls"><span class="mr-2">what application developer controls</span><a href="#what-application-developer-controls" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ol><li>on the application layer side: everything of the socket （socket中的应用层部分<li>on the transport layer side<ol><li>which <strong>transport protocol</strong> to use，传输层协议<li>the capability to fix a few transport-layer <strong>parameters</strong>(maximum buffer, maximum segment sizes) 参数，最大缓冲，最大段<li>the application is built on <strong>transport-layer services</strong> provided by that protocol 该应用将建立在该协议提供的传输层服务上</ol></ol><h3 id="13-transport-services-available-to-applications"><span class="mr-2">1.3 Transport Services Available to Applications</span><a href="#13-transport-services-available-to-applications" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><em>Conclusion：传输层协议能为应用程序提供<strong>可靠数据传输、吞吐量、实时性、安全性</strong>四个维度的服务。应用层将消息存入当前进程的socket，传输层将该消息发送给目标接收进程的socket。</em></p><p>应用层send messages through local socket，传输层send it to the socket of destination process</p><p>应用层request，传输层offer/ensure；<del>什么甲乙方关系</del></p><h4 id="4-dimensions"><span class="mr-2">4 dimensions</span><a href="#4-dimensions" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>传输协议能提供service of 4 dimensions:</p><ol><li>reliable data transfer（not necessary for loss-tolerant applications, loss/data integrity/order)<li>throughput(specific requirements for bandwidth-sensitive applications，比如视频切换清晰度，应用层可以切换编码方式来降低对带宽的需求; contrary: elastic applications)<li>timing 实时性，与吞吐量有关<li>security</ol><h3 id="14-transport-services-provided-by-the-internet"><span class="mr-2">1.4 Transport Services Provided by the Internet</span><a href="#14-transport-services-provided-by-the-internet" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>传输层协议及其提供的服务有TCP/UDP两种。<strong>TCP是面向连接的、需要三次握手的、全双工的、可靠数据传输的、有拥堵控制的；但它与UDP都没有加密技术（安全性缺陷）</strong>，因此出现了SSL（Secure socket layer），一种加入加密、端点鉴别、数据完整性技术的改良TCP协议，具体而言就是在原本的TCP通信中添加一层加密/解密socket层（这意味着它有独立的socket API），client先在SSL socket加密再传送给TCP socket，server先解密再传送给TCP socket。当今的网络能够支持时间敏感的应用，但无法支持任何对实时性与吞吐量的保证（guarantee）。</p><p><em>这些提供的服务与上一小节中的四个维度是对应的。</em></p><h4 id="tcp"><span class="mr-2">TCP</span><a href="#tcp" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ol><li>connection-oriented, handshaking, full-duplex connection<li>reliable data transfer<li>congestion-control(throughput, timing)<li>no encryption(security)</ol><h4 id="secure-sockets-layerssl"><span class="mr-2">Secure Sockets Layer(SSL)</span><a href="#secure-sockets-layerssl" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>SSL是对TCP的改良(TCP-enhanced-with-SSL)，而非一种独立的网络传输协议，其服务包括encryption, data integrity, end-point authentication端点鉴别。</p><ol><li>SSL服务代码需要被写在client和server两端的应用层<li>有独立的socket API。<li>过程：client-SSL socket(client encryption)-client TCP socket-server TCP socket-SSL socket(server decryption)-server TCP socket-server</ol><h4 id="udp"><span class="mr-2">UDP</span><a href="#udp" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ol><li>connectionless, no handshaking<li>unreliable data transfer<li>no congestion-control mechanism</ol><h3 id="15-application-layer-protocols"><span class="mr-2">1.5 Application-Layer Protocols</span><a href="#15-application-layer-protocols" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><em>Conclusion: 应用层协议是网络应用的组成之一，决定了不同终端系统上的进程如何通信，具体决定了交换的信息类型、语法、字段语义、发送响应的规则。这些协议有些是定义在RFCs中的共有协议，如HTTP，有些则是私有的，如Skype使用的协议。</em></p><h4 id="what-a-protocol-determines"><span class="mr-2">what a protocol determines</span><a href="#what-a-protocol-determines" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ol><li>交换的信息类型，request &amp; response<li>syntax，消息类型的语法，不同字段field的意思<li>when &amp; how 发送消息&amp; response</ol><h4 id="publicproprietary"><span class="mr-2">public/proprietary</span><a href="#publicproprietary" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ol><li>public：一些应用层协议在RFC(请求注解，Request For Comments)中指定，因此属于公共领域。例如HTTP RFC<li>proprietary：其余的则是私有的，例如Skype</ol><p>$application\ layer\ protocol \in application$，一个client-server应用程序可以包括：client，server，application layer protocol，standards of content format</p><p>web-mail-DNS-directory service video streaming-P2P</p><h2 id="2-the-web-and-http"><span class="mr-2">2. The Web and HTTP</span><a href="#2-the-web-and-http" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>the World Wide Web – first Internet application</p><h3 id="21-httphyper-text-transfer-protocol"><span class="mr-2">2.1 HTTP(Hyper Text Transfer Protocol)</span><a href="#21-httphyper-text-transfer-protocol" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><em>Conclusion: HTTP(Hyper Text Transfer Protocol)超文本传输协议是Web的应用层协议，其为stateless protocol，不记录client的信息。Web是client-server架构的应用程序，其采用TCP传输层协议，client与server之间利用TCP socket进行通信，server将Web page中的objects(HTML files/images etc.)传送给client作为响应。</em></p><p>HTTP, the application-layer protocol of Web</p><p>Web page(document) contains: object, such as an HTML file, image, addressable by an URL</p><p>stateless protocol 不记录client的信息</p><h4 id="architecture-client-server"><span class="mr-2">architecture: client-server</span><a href="#architecture-client-server" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ol><li>a client program/Web browsers(IE, ME, Firefox，浏览器是客户端，是Web的组成之一)<li>a server program/Web servers（管理并导向Web objects，web server always on with a fixed IP address）</ol><h4 id="transport-protocol-tcp"><span class="mr-2">transport protocol: TCP</span><a href="#transport-protocol-tcp" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>communication: client-TCP socket of client side-TCP socket of server side-server</p><p><img data-src="https://raw.githubusercontent.com/WitchPuff/typora_images/main/img/202302071455911.png" alt="image-20230207145508726" style="zoom: 50%;" data-proofer-ignore></p><h3 id="22-non-persistent-and-persistent-connections"><span class="mr-2">2.2 Non-Persistent and Persistent Connections</span><a href="#22-non-persistent-and-persistent-connections" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><em>Conclusion：在client与server之间有两种TCP连接方式，一是非持久连接，另一种是持久连接，按字面意思，非持久连接是指每次请求响应都需要建立新的TCP连接，而持久连接则沿用同一个连接进行通信。每次连接需要三次握手，耗费近2个RTT（一个小数据包从客户端到服务器再回到客户端所花费的时间），其具体过程为，client发送TCP段请求连接（initiate）、server确认并响应TCP段，client确认并发送request message，此后server才将其需要的信息及索引发送给client。使用非持久连接的缺点很显然，内存（空间，每个新建的TCP连接参数都会占用空间）和延迟（时间，每次都需要至少2个RTT）。举例，假如client需要请求的web page有10个objects，使用非持久连接一共需要建立11个TCP连接。</em></p><h4 id="non-persistent-connections"><span class="mr-2">Non-Persistent connections</span><a href="#non-persistent-connections" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>非持久连接意味着每次请求、响应都需要建立新的连接。步骤如下：</p><ol><li>client初始化一个TCP connection在[server IP:80](80是HTTP的默认端口号）<li>client通过该TCP socket发送HTTP请求信息，包含页面路由信息<li>server接收请求信息并响应其需求，通过TCP socket发送该web page需要的objects（先发送其引用，即这些objects的路由）<li>server告知TCP可以关闭连接，但直到TCP确认client完整接收响应信息才会关闭。<li>接下来每个objects都会重复1-3步</ol><p>这意味着，假如有10个objects，一共需要生成11个TCP连接（最初的是web page请求，后续的是objects请求）。</p><h4 id="round-trip-timertt"><span class="mr-2">round-trip time(RTT)</span><a href="#round-trip-timertt" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>RTT: 一个小数据包从客户端到服务器再回到客户端所花费的时间。</p><p>3次握手：</p><ol><li>client发送TCP段<li>server确认并响应一个TCP段<li>client确认（并发送request message）</ol><p><img data-src="https://raw.githubusercontent.com/WitchPuff/typora_images/main/img/202302071536749.png" alt="image-20230207153651596" style="zoom: 50%;" data-proofer-ignore></p><h4 id="shortcomings"><span class="mr-2">shortcomings</span><a href="#shortcomings" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ol><li>内存：每次创建新TCP connections需要为TCP variables分配内存，对于同时处理多clients请求的Web server来说是巨大的负担<li>延迟：每次都需要nearly 2 RTTs，一次建立连接，一次request &amp; response</ol><h4 id="persistent-connections"><span class="mr-2">persistent connections</span><a href="#persistent-connections" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>为了解决这些shortages，引出persistent connections，即部署在同一个Web Server上对多个Web Page的请求响应可以在同一个TCP connection中进行。HTTP/2能允许按优先级排列同一个TCP connection中的请求与响应。</p><h3 id="23-http-message-format"><span class="mr-2">2.3 HTTP Message Format</span><a href="#23-http-message-format" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><em>Conclusion：主要介绍了HTTP message的格式，分为request message和response message。</em></p><h4 id="request"><span class="mr-2">Request</span><a href="#request" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-http highlighter-rouge"><div class="code-header"> <span data-label-text="Http"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="nf">GET</span> <span class="nn">/somedir/page.html</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">www.someschool.edu</span>
<span class="na">Connection</span><span class="p">:</span> <span class="s">close</span>
<span class="na">User-agent</span><span class="p">:</span> <span class="s">Mozilla/5.0</span>
<span class="na">Accept-language</span><span class="p">:</span> <span class="s">fr</span>

// Entity body
</pre></table></code></div></div><p><img data-src="https://raw.githubusercontent.com/WitchPuff/typora_images/main/img/202302071624958.png" alt="image-20230207162423825" style="zoom:50%;" data-proofer-ignore></p><p><strong>request line:</strong></p><p>method</p><ol><li>GET, mostly表单提交会用到GET而非POST，如<code class="language-plaintext highlighter-rouge">www.somesite.com/search?a&amp;b</code><li>POST, 此时request message的Entity body不为空，会携带client输入的信息<li>HEAD, 与GET类似，但只有response message，没有requested object，一般用于debug<li>PUT, 用于upload an object on a Web server，一般用于Web发布工具一起使用<li>DELETE，用于delete an object on a Web server</ol><p><strong>header lines:</strong></p><ol><li>Host, needed by the web proxy caches<li>Connection, non-persistent/persistent<li>User-agent, what browser client uses<li>Accept-language, preference in languages<li>etc.</ol><h4 id="response-message"><span class="mr-2">Response Message</span><a href="#response-message" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-http highlighter-rouge"><div class="code-header"> <span data-label-text="Http"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Connection</span><span class="p">:</span> <span class="s">close</span>
<span class="na">Date</span><span class="p">:</span> <span class="s">Tue, 18 Aug 2015 15:44:04 GMT</span>
<span class="na">Server</span><span class="p">:</span> <span class="s">Apache/2.2.3 (CentOS)</span>
<span class="na">Last-Modified</span><span class="p">:</span> <span class="s">Tue, 18 Aug 2015 15:11:03 GMT</span>
<span class="na">Content-Length</span><span class="p">:</span> <span class="s">6821</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">text/html</span>

(data data data data data ...)
</pre></table></code></div></div><p><img data-src="https://raw.githubusercontent.com/WitchPuff/typora_images/main/img/202302071633678.png" alt="image-20230207163342537" style="zoom:50%;" data-proofer-ignore></p><p><strong>status line:</strong></p><ol><li>protocol version field<li>status code<ol><li>200 OK<li>301 Moved Permanently: requested <strong>object</strong>被永久移动，新的URL会在Location(one of the headers)中指出<li>400 Bad Request: incomprehensible request<li>404 Not Found: web page不存在于当前server<li>505 HTTP Version Not Supported: the requested protocol is not supported</ol><li>corresponding status message</ol><p><strong>header lines:</strong></p><ol><li>Connection: close-&gt;发完就删<li>Date，这是server检索所需object并封装发送的时间<li>server，generated by what web server<li>Last-Modified，object最后修改日期<li>Content-Length<li>Content-Type</ol><p><strong>enity body:</strong> requested data</p><h3 id="24-user-server-interaction-cookies"><span class="mr-2">2.4 User-Server Interaction: Cookies</span><a href="#24-user-server-interaction-cookies" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><em>Conclusion：用cookies来记录用户信息及其在browser上的行为，弥补HTTP无状态特点的不足，在这里client是browser，因此建立的是browser-cookie的键值关系。创建TCP连接时，server确认连接请求时给予当前client一个unique token作为cookie，server会将该cookie-client的对应关系记录在其数据库中，而client收到该cookie后会记录在本地浏览器缓存中，每次发送请求的时候会包含cookie信息。</em></p><p><img data-src="https://raw.githubusercontent.com/WitchPuff/typora_images/main/img/202302071710917.png" alt="image-20230207171033762" style="zoom:50%;" data-proofer-ignore></p><p>stateless与cookies的区别：stateless是指不记录client的状态，如果是已经response的完全一致的请求，还会再次response。cookies是记录client的历史数据信息，从该user-agent发出，在该web page进行了什么行为。</p><h3 id="25-web-caching"><span class="mr-2">2.5 Web Caching</span><a href="#25-web-caching" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><em>Conclusion：简单来说就是在原服务器与client之间添加一个代理服务器，作为web缓存，客户端先向代理服务器发送请求，确认缓存中没有需求信息后，再由代理服务器向原服务器发送请求。好处是加速、减少流量，通常client-proxy server之间的带宽限制相比client-original server的更宽松，对于ISP企业网络，能够减少当前机构局域网对互联网的访问流量，减少整个互联网上的流量。用conditional GET可以保证cache和server之间的数据一致性。</em></p><p>Web Cache-proxy server，在与client通信时是server，在与original server通信时是client，通常被ISP部署（用于大型机构网络，校园网或企业网）</p><p><img data-src="https://raw.githubusercontent.com/WitchPuff/typora_images/main/img/202302071732195.png" alt="image-20230207173204070" style="zoom:50%;" data-proofer-ignore></p><h4 id="advantages"><span class="mr-2">advantages</span><a href="#advantages" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ol><li>time cost↓，cache与client之间的传输速度上限可能比cache与server之间的传输速度上限大<li>Web缓存可以大大减少机构到Internet的访问链路上的流量<li>减少整个互联网流量</ol><h4 id="content-distribution-networkscdns"><span class="mr-2">Content Distribution Networks(CDNs)</span><a href="#content-distribution-networkscdns" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>CDN公司在整个互联网上安装许多地理分布的缓存，从而本地化大部分流量。</p><h4 id="conditional-get"><span class="mr-2">Conditional GET</span><a href="#conditional-get" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>作用：用于判断cache中的object是否up to date，保证数据一致性（consistency between cache and server）。</p><p>运行原理：client向cache请求object，假如其不在cache中，cache向server请求，此时server会将object的last modified信息一起发送，cache保存这个信息。若在cache中，cache会先向server发送一个conditional GET作为一个up-to-date的确认，该报文包含If-modified-since属性，值与last modified相同，假如没有改变，server会response with<code class="language-plaintext highlighter-rouge">304 Not Modified</code>，不会再次传送object（entity body为空）。此时cache确认后，可以直接将缓存中的object响应给client。</p><h2 id="3-electronic-mail"><span class="mr-2">3. Electronic Mail</span><a href="#3-electronic-mail" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="31-internet-mail-system"><span class="mr-2">3.1 Internet mail system</span><a href="#31-internet-mail-system" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><em>Conclusion: 互联网邮件系统主要包含用户代理、邮件服务器与SMTP三个组成部分，用户代理对邮件进行操作，服务器储存、传送邮件，SMTP为服务器之间的TCP连接传输遵循的协议。</em></p><ol><li>user agents, where the user operates<li>mail servers, both client and server among other mail servers，存储数据、传送数据<li>SMTP(Simple Mail Transfer Protocol)，mail servers之间的TCP连接通信遵循SMTP服务</ol><p><img data-src="https://raw.githubusercontent.com/WitchPuff/typora_images/main/img/202302101655321.png" alt="image-20230210165522194" style="zoom:50%;" data-proofer-ignore></p><p><img data-src="https://raw.githubusercontent.com/WitchPuff/typora_images/main/img/202302121554855.png" alt="image-20230212155423722" style="zoom: 67%;" data-proofer-ignore></p><h3 id="32-comparisons-between-http--smtp"><span class="mr-2">3.2 Comparisons between HTTP &amp; SMTP</span><a href="#32-comparisons-between-http--smtp" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="table-wrapper"><table><thead><tr><th> <th>HTTP<th>SMTP<tbody><tr><td><strong>pull/push</strong><td>pull protocol，侧重download被upload在web server上的文件，TCP连接由client初始化（发出请求）<td>push protocol，侧重推送文件，TCP连接由发送邮件的mail server初始化<tr><td><strong>format limitations</strong><td>无<td>信息格式limited，7-bit ASCII format<tr><td><strong>objects-messages</strong><td>将单个requested object封装在一条message，一对一<td>将所有objects封装在一条message</table></div><h3 id="33-mail-message-formats"><span class="mr-2">3.3 Mail Message Formats</span><a href="#33-mail-message-formats" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>From: alice@crepes.fr
To: bob@hamburger.edu
Subject: Searching for the meaning of life.
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>telnet serverName 25
</pre></table></code></div></div><p>25 is the port number of SMTP server</p><h3 id="34-mail-access-protocols"><span class="mr-2">3.4 Mail Access Protocols</span><a href="#34-mail-access-protocols" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><em>Conclusion: 收信人不能再采用SMTP来接收message，因为SMTP是push protocol而非pull protocol，因此要采用mail access protocols: POP3, IMAP, HTTP。POP3的运行具有3阶段，认证（用户名密码登陆）、业务（撤回、标记删除邮件、保存邮件数据）、更新（根据标记删除邮件，quit结束会话）。IMAP相比POP3，能够保存会话中的用户状态信息，具有文件夹分类功能，这也导致其实现比POP3要复杂得多。</em></p><h4 id="post-office-protocolversion-3-pop3"><span class="mr-2">Post Office Protocol—Version 3 (POP3)</span><a href="#post-office-protocolversion-3-pop3" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>3 phases:</p><ol><li>authorization: username-password<li>transaction: retrieve/mark for deletion/obtain data<li>update: issue <code class="language-plaintext highlighter-rouge">quit</code> command, end the session; delete the marked messages</ol><p>commands: <code class="language-plaintext highlighter-rouge">list</code>,<code class="language-plaintext highlighter-rouge">retr</code>,<code class="language-plaintext highlighter-rouge">dele</code>,<code class="language-plaintext highlighter-rouge">quit</code></p><h4 id="internet-mail-access-protocol-imap"><span class="mr-2">Internet Mail Access Protocol (IMAP)</span><a href="#internet-mail-access-protocol-imap" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>相比POP3，多了文件夹分类功能，这意味着IMAP会保存IMAP session中的用户状态信息，例如分类和文件夹名</p><p><img data-src="https://raw.githubusercontent.com/WitchPuff/typora_images/main/img/202302122139584.png" alt="image-20230212164315736" style="zoom: 67%;" data-proofer-ignore></p><h2 id="4-dnsdomain-name-system"><span class="mr-2">4. DNS(Domain Name System)</span><a href="#4-dnsdomain-name-system" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>已知：用hostname和IP地址可以定位一个主机</p><p>需求：路由器需要定长的、分级的IP地址，需要建立hostname到IP地址的映射，即域名解析DNS</p><h3 id="41-services-provided-by-dns"><span class="mr-2">4.1 Services provided by DNS</span><a href="#41-services-provided-by-dns" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><em>Conclusion: DNS包括在DNS servers层次结构中实现的分布式数据库，以及允许host查询分布式数据库的application-layer protocol。DNS是一个应用，其提供的服务为伪域名查询和负载平衡。</em></p><h4 id="definition"><span class="mr-2">definition</span><a href="#definition" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ol><li>在DNS服务器层次结构中实现的分布式数据库<li>允许主机查询分布式数据库的应用层协议</ol><p>一般是UNIX机器，DNS protocol一般在UDP和端口53上运行，一般被其他应用层协议，如HTTP,SMTP应用。</p><p><strong>应用原理：</strong></p><p><img data-src="https://raw.githubusercontent.com/WitchPuff/typora_images/main/img/202302140124680.png" alt="image-20230214012429591" style="zoom:67%;" data-proofer-ignore></p><ol><li>browser client将hostname传送给DNS应用的client side<li>DNS client将hostname传送给server，等待server回应该hostname对应的IP地址<li>browser client接收DNS应用传来的IP地址，初始化TCP连接</ol><p><strong>services:</strong></p><ol><li>host/mail server aliasing，主机/邮箱伪域名，DNS能找到一个alias hostname的canonical hostname及其IP<li>Load Distribution，负载平衡，对于重复的不同终端上的web servers，其canonical hostname一致，但拥有不同的IP地址，DNS能获取并响应这组IP地址，但会对其顺序进行轮换，由于client一般会按顺序优先采用这个地址集中的IP地址，从而起到了分流的作用。</ol><h3 id="42-how-dns-works"><span class="mr-2">4.2 How DNS Works</span><a href="#42-how-dns-works" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><em>Conclusion: 中心化设计的DNS具有单点故障（一损俱损）、流量代价、中心数据库距离远、维持成本高（经常需要更新hosts信息）的缺点，因此DNS服务器采用分布式和分级设计，具有三层分级，root，TLD，authoritative，每一层分别提供下一层的IP地址，最后还有local DNS，作为host到三级DNS服务器的proxy server，也能储存TLD server和短期内查询过的hostname的缓存。</em></p><p>shortages of a centralized design of DNS:</p><ol><li>single point of failure 单点故障<li>traffic volume 流量代价<li>distant centralized database 遥远<li>maintenance 维持成本（更新hosts信息）</ol><p>因此要有distributed and hierarchical design</p><h4 id="3-classes-of-dns-servers"><span class="mr-2">3 classes of DNS servers</span><a href="#3-classes-of-dns-servers" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><img data-src="https://raw.githubusercontent.com/WitchPuff/typora_images/main/img/202302122139452.png" alt="image-20230212210955098" style="zoom: 80%;" data-proofer-ignore></p><ol><li>Root DNS servers, 提供TLD servers的IP地址<li>Top-level domain(TLD) servers, <code class="language-plaintext highlighter-rouge">com, org, net, edu, and gov</code>，提供authoritative DNS servers的IP地址<li>Authoritative DNS servers, 在Internet上拥有可公开访问的主机(如Web服务器和邮件服务器)的每个<strong>组织</strong>都必须提供可公开访问的DNS记录，这些记录包含hostname到IP地址的映射。组织的授权DNS服务器保存这些DNS记录。<li>local DNS server, 严格来说不属于DNS服务器层级，但是DNS架构的中心；每个ISP都会有一个local DNS server，作为一个在请求host和DNS server hierarchy（以上三种）之间的proxy server</ol><p><img data-src="https://raw.githubusercontent.com/WitchPuff/typora_images/main/img/202302122139550.png" alt="image-20230212213909456" style="zoom:67%;" data-proofer-ignore></p><p>从请求主机到本地DNS服务器的查询是递归的，其余查询是迭代的。</p><h4 id="cache"><span class="mr-2">cache</span><a href="#cache" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>local DNS server could <strong>cache</strong> IP of</p><ol><li>TLD servers<li>same hostnames recently</ol><h3 id="43-dns-records-and-messages"><span class="mr-2">4.3 DNS Records and Messages</span><a href="#43-dns-records-and-messages" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Resource records(RRs)：cache中对hostname-IP mappings的记录</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>(Name, Value, Type, TTL)
</pre></table></code></div></div><h4 id="参数"><span class="mr-2">参数</span><a href="#参数" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="table-wrapper"><table><thead><tr><th>Type<th>Name<th>Value<th>Example<tbody><tr><td>A<td>hostname<td>IP address<td>$(relay1.bar.foo.com, 145.37.93.126, A)$<tr><td>NS<td>domain<td>能提供该域名族host的IP地址的authoritative DNS server的hostname<td>$(foo.com,dns.foo.com, NS) $<tr><td>CNAME<td>alias hostname<td>canonical hostname<td>$(foo.com,relay1.bar.foo.com, CNAME)$<tr><td>MX<td>alias hostname<td>canonical name of a mail server<td>$(foo.com, mail.bar.foo.com, MX)$</table></div><p><img data-src="https://raw.githubusercontent.com/WitchPuff/typora_images/main/img/202302131605629.png" alt="image-20230213160553467" style="zoom: 80%;" data-proofer-ignore></p><h4 id="安全性"><span class="mr-2">安全性</span><a href="#安全性" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>针对DNS的攻击：</p><ol><li><strong>DDoS（分布式拒绝服务）</strong>带宽泛洪攻击，向每个root DNS server发送大量packet，使得大多数合法DNS请求得不到回答。<li>截获来自主机的请求，并返回伪造的回答，替换服务器的缓存信息，能将Web用户重定向到病毒Web站点。</ol><h3 id="44-distribution"><span class="mr-2">4.4 Distribution</span><a href="#44-distribution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><h4 id="p2p-file-distribution"><span class="mr-2">P2P File Distribution</span><a href="#p2p-file-distribution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>从单一服务器向大量主机分发一个大文件。将不同小的片段发送给不同主机，让主机之间相互匹配传输缺失的部分；比client-server更高效。eg. BitTorrent</p><h4 id="dash"><span class="mr-2">DASH</span><a href="#dash" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>DASH(Dynamic Adaptive Streaming over HTTP) 经HTTP的动态适应性流，改变视频流编码，360p-1080p</p><h4 id="cdn-content-distribution-network"><span class="mr-2">CDN (Content Distribution Network)</span><a href="#cdn-content-distribution-network" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>CDN，内容分发网在为client播放流媒体时缓存该视频，当缓存满了则移除较少访问的视频。</p><p><strong>分布方式：</strong></p><ol><li>enter-deep：在ISPs附近布置服务器，这样服务器的数量会比较大，Akamai采用这种方法<li>bring-home：在Internet Exchange Points（IXPs）布置服务器，这样服务器数量较少，Limelight等CDN公司采用这种方法</ol><p><strong>运行原理：</strong></p><p><img data-src="https://raw.githubusercontent.com/WitchPuff/typora_images/main/img/202302131734365.png" alt="image-20230213173431201" style="zoom:50%;" data-proofer-ignore></p><h4 id="cluster-selection-strategies"><span class="mr-2">cluster selection strategies</span><a href="#cluster-selection-strategies" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ol><li>geographically closest 地理最近，弊端是每次都固定一个cluster，不考虑现实延迟和宽带上限，有时地理最近在网络上不是最近，且有些终端与定位较远的LDNSs绑定<li>real-time measurements 实时测量，让CDN中的clusters周期性地测量到达速度最快的LDNSs</ol><h3 id="45-netflix-youtube-and-kankan"><span class="mr-2">4.5 Netflix, YouTube, and kankan</span><a href="#45-netflix-youtube-and-kankan" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><h4 id="netflix"><span class="mr-2">Netflix</span><a href="#netflix" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>网飞的web pages分发由Akamai公司运营，视频内容分发主要依靠Amazon cloud &amp; private CDN。该网站是在亚马逊云中的亚马逊服务器运营的，亚马逊云实现了以下功能：</p><ol><li>Content ingestion，把原片上传到亚马逊云中的hosts<li>Content processing，亚马逊云对视频进行各种编码并存储，以适应不同终端、流畅度、清晰度播放（DASH）<li>Uploading versions to its CDN，将这些不同版本的视频上传到其private CDN</ol><p><img data-src="https://raw.githubusercontent.com/WitchPuff/typora_images/main/img/202302140109437.png" alt="image-20230214010905870" style="zoom:50%;" data-proofer-ignore></p><p>push caching:</p><p>Netflix CDN uses push caching rather than pull caching，意思是在非高峰期定期将内容推送到服务器，而非高峰期需要的时候再pull</p><h4 id="youtube"><span class="mr-2">YouTube</span><a href="#youtube" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>private CDN/pull caching/cluster-selection：找出RTT最短的cluster，但为了保持平衡一般会通过DNS定向到更远的cluster/<em>现在已经有了适应性流媒，有一些视频使用DASH（书是2017出版，2018 stackoverflow说youtube还在使用dash）</em></p><h3 id="46-client-server-application-using-udptcp"><span class="mr-2">4.6 client-server application using UDP/TCP</span><a href="#46-client-server-application-using-udptcp" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><img data-src="https://raw.githubusercontent.com/WitchPuff/typora_images/main/img/202302131813791.png" alt="image-20230213181307672" style="zoom: 67%;" data-proofer-ignore></p><p><img data-src="https://raw.githubusercontent.com/WitchPuff/typora_images/main/img/202302140031194.png" alt="image-20230214003116046" style="zoom:67%;" data-proofer-ignore></p><p><em>记点好玩的：</em></p><p><em>RFC 2324: “<a href="https://baike.baidu.com/item/超文本咖啡壶控制协议/8410606?fromModule=lemma_inlink">超文本咖啡壶控制协议</a>”（Hyper Text Coffee Pot Control Protocol，乍有其事的写了HTCPCP这样看起来很专业的术语缩写字）。以及如前面所提到纪念RFC的30周年庆的RFC文件。</em></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/courses/'>Courses</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/computer-network/" class="post-tag no-text-decoration" >Computer Network</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Computer+Network%3A+Application+Layer+-+CyberWitch&url=https%3A%2F%2Fwitchpuff.github.io%2Fposts%2FApplication%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Computer+Network%3A+Application+Layer+-+CyberWitch&u=https%3A%2F%2Fwitchpuff.github.io%2Fposts%2FApplication%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fwitchpuff.github.io%2Fposts%2FApplication%2F&text=Computer+Network%3A+Application+Layer+-+CyberWitch" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="http://service.weibo.com/share/share.php?title=Computer+Network%3A+Application+Layer+-+CyberWitch&url=https%3A%2F%2Fwitchpuff.github.io%2Fposts%2FApplication%2F" data-toggle="tooltip" data-placement="top" title="Weibo" target="_blank" rel="noopener" aria-label="Weibo"> <i class="fa-fw fab fa-weibo"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/transport/">Computer Network: Transport Layer(2)</a><li><a href="/posts/classification/">Machine Learning: Classification</a><li><a href="/posts/sqlite3/">ModuleNotFoundError: No module named '_sqlite3'解决方法</a><li><a href="/posts/clustering/">Machine Learning: Clustering</a><li><a href="/posts/astar/">Solving 15-Puzzle with A* and IDA*</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ai/">AI</a> <a class="post-tag" href="/tags/computer-network/">Computer Network</a> <a class="post-tag" href="/tags/machine-learning/">Machine Learning</a> <a class="post-tag" href="/tags/bart/">BART</a> <a class="post-tag" href="/tags/music-generation/">Music Generation</a> <a class="post-tag" href="/tags/searching/">Searching</a> <a class="post-tag" href="/tags/a/">A*</a> <a class="post-tag" href="/tags/clustering/">Clustering</a> <a class="post-tag" href="/tags/cnn/">CNN</a> <a class="post-tag" href="/tags/computer-architecture/">Computer Architecture</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/NetworkLayerControlPlane/"><div class="card-body"> <em class="small" data-ts="1675992990" data-df="ll" > Feb 10, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Computer Network: Control Plane of Network Layer</h3><div class="text-muted small"><p> Network Layer: Control Plane RIP, Router Information Protocol OSPF(Open Shortest Path First，开放式最短路径优先) 层次化路由 Network Layer: Control Plane 路由算法 集中式：全局网络知识计算，需...</p></div></div></a></div><div class="card"> <a href="/posts/NetworkLayerDataPlane/"><div class="card-body"> <em class="small" data-ts="1675992990" data-df="ll" > Feb 10, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Computer Network: Data Plane of Network Layer</h3><div class="text-muted small"><p> Network Layer: Data Plane 1. Network Layer Services 2. Router 2.1 input port processing 2.2 Switching fabric 2.2.1 switching...</p></div></div></a></div><div class="card"> <a href="/posts/transport/"><div class="card-body"> <em class="small" data-ts="1676079630" data-df="ll" > Feb 11, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Computer Network: Transport Layer(2)</h3><div class="text-muted small"><p> Transport Layer Transport-Layer Services Multiplexing &amp;amp; Demultiplexing UDP RDT TCP 1. Transport-Layer Services...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/computerArchitecture/" class="btn btn-outline-primary" prompt="Older"><p>计算机体系结构文献综述</p></a> <a href="/posts/NetworkLayerControlPlane/" class="btn btn-outline-primary" prompt="Newer"><p>Computer Network: Control Plane of Network Layer</p></a></div><script type="text/javascript"> $(function () { const origin = "https://giscus.app"; const iframe = "iframe.giscus-frame"; const lightTheme = "light"; const darkTheme = "dark_dimmed"; let initTheme = lightTheme; if ($("html[data-mode=dark]").length > 0 || ($("html[data-mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches)) { initTheme = darkTheme; } let giscusAttributes = { "src": "https://giscus.app/client.js", "data-repo": "WitchPuff/WitchPuff.github.io", "data-repo-id": "R_kgDOHwS97Q", "data-category": "Announcements", "data-category-id": "DIC_kwDOHwS97c4CQnTG", "data-mapping": "pathname", "data-reactions-enabled": "1", "data-emit-metadata": "0", "data-theme": initTheme, "data-input-position": "bottom", "data-lang": "en", "crossorigin": "anonymous", "async": "" }; let giscusScript = document.createElement("script"); Object.entries(giscusAttributes).forEach(([key, value]) => giscusScript.setAttribute(key, value)); document.getElementById("tail-wrapper").appendChild(giscusScript); addEventListener("message", (event) => { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { /* global theme mode changed */ const mode = event.data.message; const theme = (mode === ModeToggle.DARK_MODE ? darkTheme : lightTheme); const message = { setConfig: { theme: theme } }; const giscus = document.querySelector(iframe).contentWindow; giscus.postMessage({ giscus: message }, origin); } }); }); </script></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2023 <a href="">WitchPuff</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ai/">AI</a> <a class="post-tag" href="/tags/computer-network/">Computer Network</a> <a class="post-tag" href="/tags/machine-learning/">Machine Learning</a> <a class="post-tag" href="/tags/bart/">BART</a> <a class="post-tag" href="/tags/music-generation/">Music Generation</a> <a class="post-tag" href="/tags/searching/">Searching</a> <a class="post-tag" href="/tags/a/">A*</a> <a class="post-tag" href="/tags/clustering/">Clustering</a> <a class="post-tag" href="/tags/cnn/">CNN</a> <a class="post-tag" href="/tags/computer-architecture/">Computer Architecture</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
